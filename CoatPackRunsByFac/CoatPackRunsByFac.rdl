<?xml version="1.0" encoding="utf-8"?>
<Report MustUnderstand="df" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns:df="http://schemas.microsoft.com/sqlserver/reporting/2016/01/reportdefinition/defaultfontfamily">
  <df:DefaultFontFamily>Segoe UI</df:DefaultFontFamily>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="CoatPack_MDMS_RPT">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString>Data Source=MAPHPCRPP01\PROD;Initial Catalog=CoatPack_MDMS_RPT</ConnectString>
        <IntegratedSecurity>true</IntegratedSecurity>
      </ConnectionProperties>
      <rd:SecurityType>Integrated</rd:SecurityType>
      <rd:DataSourceID>48e936bb-4800-4ae3-bc55-1475d3e67af3</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="qGetProcessEntities">
      <Query>
        <DataSourceName>CoatPack_MDMS_RPT</DataSourceName>
        <CommandText>-- get all unique process entity descriptions in CPS.
select distinct vPE.[Desc]
from CoatPack_MDMS_RPT.dbo.vw_ProcessEntity as vPE
</CommandText>
      </Query>
      <Fields>
        <Field Name="Desc">
          <DataField>Desc</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="qGetProcessParams">
      <Query>
        <DataSourceName>CoatPack_MDMS_RPT</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@pProcessEntity">
            <Value>=Parameters!pProcessEntity.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>-- Following query generates results table containing all relevent process parameters for a given
-- process entity name.

select distinct tPPT.[Name], tCPE.[Desc]
from CoatPack_MDMS_RPT.dbo.ProcParmType as tPPT

	inner join CoatPack_MDMS_RPT.dbo.CurrentProcessEntityType as tCPET
		on tCPET.ProcEntTypeRevID = tPPT.ProcEntTypeRevID

	inner join CoatPack_MDMS_RPT.dbo.CurrentProcessEntity as tCPE
		on tCPE.ProcEntTypeID = tCPET.ProcEntTypeID

where tCPE.[Desc] = @pProcessEntity

order by tPPT.[Name] asc</CommandText>
      </Query>
      <Fields>
        <Field Name="Name">
          <DataField>Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Desc">
          <DataField>Desc</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="qResults">
      <Query>
        <DataSourceName>CoatPack_MDMS_RPT</DataSourceName>
        <CommandText>-- Given search type, one of three queries are run.

if (@pQueryType = 'RUNS')
	-- Query #1; returns results table for number of previous runs specified by @pNumRuns.
	begin 
		select top (@pNumRuns) tPE.[Desc] --vpe.[Name]
		from CoatPack_MDMS_RPT.dbo.ProcessEntity as tPE

		-- TODO
	end
else if (@pQueryType = 'BATCH_NUMBER')
	-- Query #2; returns results table filtered by batch number specified by @pBatch.
	begin
		select tPE.[Desc]
		from CoatPack_MDMS_RPT.dbo.ProcessEntity as tPE
		-- TODO
	end
else if (@pQueryType = 'DATE_RANGE')
	-- Query #3; returns results table filtered by date where @pStartTime &lt;= date &lt;= @pEndTime.
	begin
		select tPE.[Desc]
		from CoatPack_MDMS_RPT.dbo.ProcessEntity as tPE
		-- TODO
	end</CommandText>
      </Query>
      <Fields>
        <Field Name="Desc">
          <DataField>Desc</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Tablix1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1in</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox1">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox1</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox3">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox3</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox5">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox5</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.25in</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox2">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox2</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox4">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox4</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Textbox6">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                              <Style />
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>Textbox6</rd:DefaultName>
                          <Style>
                            <Border>
                              <Color>LightGrey</Color>
                              <Style>Solid</Style>
                            </Border>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <KeepWithGroup>After</KeepWithGroup>
                </TablixMember>
                <TablixMember>
                  <Group Name="Details" />
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>qResults</DataSetName>
            <Height>0.5in</Height>
            <Width>3in</Width>
            <Style>
              <Border>
                <Style>None</Style>
              </Border>
            </Style>
          </Tablix>
        </ReportItems>
        <Height>2.405in</Height>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Body>
      <Width>9.87375in</Width>
      <Page>
        <LeftMargin>1in</LeftMargin>
        <RightMargin>1in</RightMargin>
        <TopMargin>1in</TopMargin>
        <BottomMargin>1in</BottomMargin>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <ReportParameters>
    <ReportParameter Name="pSearchType">
      <DataType>String</DataType>
      <DefaultValue>
        <Values>
          <Value>SEARCH_BY_RUNS</Value>
        </Values>
      </DefaultValue>
      <Prompt>Search Type:</Prompt>
      <ValidValues>
        <ParameterValues>
          <ParameterValue>
            <Value>SEARCH_BY_RUNS</Value>
            <Label>Runs</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>SEARCH_BY_BATCH_NUMBER</Value>
            <Label>Batch Number</Label>
          </ParameterValue>
          <ParameterValue>
            <Value>SEARCH_BY_DATE_RANGE</Value>
            <Label>Date Range</Label>
          </ParameterValue>
        </ParameterValues>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="pProcessEntity">
      <DataType>String</DataType>
      <Prompt>Select Process Entity:</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>qGetProcessEntities</DataSetName>
          <ValueField>Desc</ValueField>
          <LabelField>Desc</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="pProcessParams">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>qGetProcessParams</DataSetName>
          <ValueField>Name</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Select Process Parameters:</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>qGetProcessParams</DataSetName>
          <ValueField>Name</ValueField>
          <LabelField>Name</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="pNumRuns">
      <DataType>Integer</DataType>
      <DefaultValue>
        <Values>
          <Value>100</Value>
        </Values>
      </DefaultValue>
      <Prompt>Enter Number of Runs:</Prompt>
    </ReportParameter>
    <ReportParameter Name="pBatch">
      <DataType>String</DataType>
      <AllowBlank>true</AllowBlank>
      <Prompt>Enter Batch Number:</Prompt>
    </ReportParameter>
    <ReportParameter Name="pStartTime">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>=DateAdd("h", -24, NOW())</Value>
        </Values>
      </DefaultValue>
      <Prompt>Select Start Time:</Prompt>
    </ReportParameter>
    <ReportParameter Name="pEndTime">
      <DataType>DateTime</DataType>
      <DefaultValue>
        <Values>
          <Value>=Now()</Value>
        </Values>
      </DefaultValue>
      <Prompt>Select End Time:</Prompt>
    </ReportParameter>
  </ReportParameters>
  <ReportParametersLayout>
    <GridLayoutDefinition>
      <NumberOfColumns>2</NumberOfColumns>
      <NumberOfRows>6</NumberOfRows>
      <CellDefinitions>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>1</RowIndex>
          <ParameterName>pProcessEntity</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>4</RowIndex>
          <ParameterName>pBatch</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>3</RowIndex>
          <ParameterName>pNumRuns</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>5</RowIndex>
          <ParameterName>pStartTime</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>1</ColumnIndex>
          <RowIndex>5</RowIndex>
          <ParameterName>pEndTime</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>2</RowIndex>
          <ParameterName>pProcessParams</ParameterName>
        </CellDefinition>
        <CellDefinition>
          <ColumnIndex>0</ColumnIndex>
          <RowIndex>0</RowIndex>
          <ParameterName>pSearchType</ParameterName>
        </CellDefinition>
      </CellDefinitions>
    </GridLayoutDefinition>
  </ReportParametersLayout>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>b6f1718b-6cde-4103-9555-5165a079e21a</rd:ReportID>
</Report>